{
    "id": 20716856440082,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/20716856440082.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20716856440082-EFS-Admin-Configuration",
    "author_id": 369584192734,
    "comments_disabled": false,
    "draft": true,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20714711445138,
    "created_at": "2024-08-12T19:51:45Z",
    "updated_at": "2024-08-12T19:51:57Z",
    "name": "EFS Admin Configuration",
    "title": "EFS Admin Configuration",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-08-12T19:51:57Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<p><b>Original Confluence URL:</b> <a href=\"https://qbdocs.atlassian.net/wiki/spaces/IAM/pages/1217462423\">https://qbdocs.atlassian.net/wiki/spaces/IAM/pages/1217462423</a> - please cross-check the quality of the ZD article with the Confluence counterpart and remove this line before publishing the ZD article</p>\n\n<h2>Table of Contents</h2>\n<ul class=\"toc\">\n<ul>\n<li><a href=\"#header-1\">Step 0: Whitelist</a></li>\n<ul>\n<li><a href=\"#header-3\">Step 1: Navigate to platform cockpit</a></li>\n<ul>\n<li><a href=\"#header-5\">Step 2: Add IdentityAccessManager Module</a></li>\n<li><a href=\"#header-6\">Step 3: Configure IdentityAccessManager module</a></li>\n<li><a href=\"#header-7\">Setp 4: Migrate admin users via script</a></li>\n<li><a href=\"#header-8\">Step 5: Set IdentityAccessManager Module active</a></li>\n<li><a href=\"#header-9\">Step 6: Activate admin users via script</a></li>\n<li><a href=\"#header-10\">Step 7: Kill all activte sessions to avoid relogin after logout</a></li>\n<li><a href=\"#header-11\">Step 8: OPTIONAL - Migrate portals applications, Panelists and EFS Admin users with installation group ID</a></li>\n<li><a href=\"#header-12\">Sync “Exclusion” (iam_federated_domains)</a></li>\n<li><a href=\"#header-13\">Identity Provider ID (iam_idp_id)</a></li>\n</ul>\n</ul>\n</ul>\n</ul><p>For more details see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title='Module \"IdentityAccessManager\"' ri:version-at-save=\"20\"></ri:page><ac:link-body>Module \"IdentityAccessManager\"</ac:link-body></ac:link> </p><h1 id=\"header-1\">Step 0: Whitelist</h1><p>Take care that the Okta production address is whitelisted in our Proxy. Usually this should already be the case.</p><h2 id=\"header-3\">Step 1: Navigate to platform cockpit</h2><p><em>System → Options → Plattform-Cockpit → System configuration</em></p><h3 id=\"header-5\">Step 2: Add IdentityAccessManager Module</h3><p>The module IdentityAccessManager is not part of the default modules. It can be added when searching for “IdentityAccessManager”.</p><p>The module depends on the modules “efs” and “survey” - they have to be added.</p><p>In case Portals should be used for Tivian Access “panel“ and “portal” modules are also required and have to added.</p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/20716856704018\" alt=\"module_setup.png\"><p></p><h3 id=\"header-6\">Step 3: Configure IdentityAccessManager module</h3><p><strong>Values:</strong></p><p>see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title='Module \"IdentityAccessManager\"' ri:version-at-save=\"20\"></ri:page><ac:link-body>Module \"IdentityAccessManager\"</ac:link-body></ac:link> </p><p>also see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"General Tenant Setup\" ri:version-at-save=\"3\"></ri:page><ac:link-body>General Tenant Setup</ac:link-body></ac:link>  and <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"EFS Admin Setup\" ri:version-at-save=\"10\"></ri:page><ac:link-body>EFS Admin Setup</ac:link-body></ac:link> and <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"Authorization Server\" ri:version-at-save=\"1\"></ri:page><ac:link-body>Authorization Server</ac:link-body></ac:link> </p><p><em><strong>iam_admin_bypass_login_route: </strong></em>A route that will be used for Tivian internal root users (leave at default)</p><p><em><strong>iam_api_token</strong>:</em> The token created in the General Tenant Setup → KeyPass </p><p><em><strong>iam_audience</strong>:</em> The audience that is configured in the Okta authorization server (Security → API → Authorization Servers)</p><p><em><strong>iam_client_group_id: </strong></em>The ID of the groupd specified in Okta for that specific installation (Groups → ID in URL)</p><p><em><strong>iam_client_id</strong>:</em> The ID of the created application in Okta for EFS Admin (Applications → Edit → General / KeyPass)</p><p><em><strong>iam_client_secret</strong>:</em> The secret of the created application in Okta for EFS Admin (Applications → Edit → General / KeyPass)</p><p><em><strong>iam_federated_domains</strong>:</em> d<ac:inline-comment-marker ac:ref=\"007374f6-4639-422f-818d-3af2cf8d898a\">omains that w</ac:inline-comment-marker>ill be forwarded to the any IdP, see below (this option is important)</p><p><em><strong>iam_idp_id: </strong></em>The identity provider ID that references the external identity provider (see below)</p><p><em><strong>iam_panelist_sync:</strong></em> Adapt whether users should be synchronized and activated or not (see federated domains first)</p><p><em><strong>iam_post_logout_redirect_url:</strong></em> &lt;domain and protocol&gt;/iam/admin/auth/logoutSuccess (technical domain, exept if the installation has a domain redirect from technical to an alias in place, then alias domain)</p><p><em><strong>iam_proxy_url</strong>:</em> Ask IT second level support (most likely http://proxy:8080, exept AWS: <a href=\"http://squid.global-services.svc.cluster.local:8080\">http://squid.global-services.svc.cluster.local:8080</a>) → <u>also see below</u></p><p><em><strong>iam_redirect_url</strong>:</em> &lt;domain and protocol&gt;/iam/admin/auth/login also see EFS Admin Setup (technical domain, exept if the installation has a domain redirect from technical to an alias in place, then alias domain)</p><p><em><strong>iam_support_email</strong>:</em> The mail address of whoever will be answering questions regarding Tivian Access</p><p><em><strong>iam_sso_modules:</strong></em> Adapt whether Tivian Access should be enabled for EFS Admin only or Portals too</p><p><em><strong>iam_unique_customer_name:</strong></em> A unique name of the client that is also used for other Okta resources (see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"Naming conventions in Okta\" ri:version-at-save=\"14\"></ri:page><ac:link-body>Naming conventions in Okta</ac:link-body></ac:link>)</p><p><em><strong>iam_user_group_id:</strong></em> This is the group ID of the client (the non-installation-specific one). It has to be created beforehand (Groups → ID in URL) (see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"General Tenant Setup\" ri:version-at-save=\"3\"></ri:page><ac:link-body>General Tenant Setup</ac:link-body></ac:link>).</p><p><em><strong>iam_well_known_url</strong>: </em>The metadata URL that is proposed in the Authorization Server in Okta (Security → API → Edit → Metadata URI) also see Authorization Server </p><p></p><h3 id=\"header-7\">Setp 4: Migrate admin users via script</h3><p>This step is used to migrate admin users. The “iam_federated_domains” option has to be set here already to the correct final domain set.</p><ul>\n<li><p>Login to the console of the installation to start the migration script.</p></li>\n<li><p>Navigate to the “www“-folder of the installation.</p></li>\n<li><p>Execute the migration script in “support/iam/migration.php“.</p></li>\n<li><p>Chose “Admin user migration”</p></li>\n<li><p>Check if that worked (this is a good point in time to test with a client if everything works)</p></li>\n</ul><h3 id=\"header-8\">Step 5: Set IdentityAccessManager Module active</h3><p><strong>Values:</strong></p><p><em><strong>iam_module_active</strong>:</em> true (<strong>Caution:</strong> Enable this as soon as all other settings are correct! This will enable SSO. Only the root user can bypass the Okta login after this point.)</p><p></p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/20716849959442\" alt=\"Screenshot_2019-12-19 Options.png\"><p></p><h3 id=\"header-9\">Step 6: Activate admin users via script</h3><p>The IAM module is now activated. But the respective admin users that are not part of the external IdP have to be activated to login.</p><ul>\n<li><p>Login to the console of the installation to start the migration script.</p></li>\n<li><p>Navigate to the “www“-folder of the installation.</p></li>\n<li><p>Execute the migration script in “support/iam/migration.php“.</p></li>\n<li><p>Chose “Admin user activation“</p></li>\n</ul><h3 id=\"header-10\">Step 7: Kill all activte sessions to avoid relogin after logout</h3><ul>\n<li><p>execute scipt: /www/support/iam/clearSessions.php</p></li>\n<li><p>error that idp_tokens does not exist can be ignored</p></li>\n</ul><h3 id=\"header-11\">Step 8: OPTIONAL - Migrate portals applications, Panelists and EFS Admin users with installation group ID</h3><p>If the installation was setup with IAM in <strong>19.5</strong> this migration is mandatory. It will assign all users (EFS Admin users and Panelists) from the current installation to the installation specific group set in the EFS configuration.</p><ul>\n<li><p>Login to the console of the installation to start the migration script.</p></li>\n<li><p>Navigate to the “www“-folder of the installation</p></li>\n<li><p>Execute the migration script in “support/iam/migration.php”</p></li>\n<li><p>Chose “Portal ClientGroup migration“ - wait until done</p></li>\n<li><p>Execute the migration script again</p></li>\n<li><p>Chose “User ClientGroup migration“</p></li>\n</ul><p></p><h3 id=\"header-12\">Sync “Exclusion” (iam_federated_domains)</h3><p>Users from EFS will be synced to Okta. A synced user will be created in Okta and will get an activation e-mail. The link in the activation e-mail will navigate the user to a page where the Okta password has to be provided.</p><p>Also users from an Identity Provider would receive such an e-mail and would provide a password they would never use as they do not user their Okta user but their external Identity Provider user.</p><p>To prevent such confusing e-mails users that are using their own Identity Provider will get synced to Okta without that kind of activation. Thus every e-mail domain that will get routed to an Identity Provider for this installation has to be added in the iam_federated_domains option.</p><p>This has to happen before the sync is enabled. Else a wrong set of users will be migrated to Okta.</p><p>Also see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"EFS Admin Setup\" ri:version-at-save=\"10\"></ri:page><ac:link-body>EFS Admin Setup</ac:link-body></ac:link> </p><h3 id=\"header-13\">Identity Provider ID (iam_idp_id)</h3><p>If a customer has their own Identity Provider this provider is created as resource in Okta. In case a client wants their user to skip the identity provider discovery page that is shown in Okta, the ID of the identity provider resource in Okta could be set here.</p><p>In that case the identity provider ID is already known in case a user tries to sign in and the user will be redirected to the identity provider directly without seeing an Okta page.</p><p>This might have an effect on how Tivian users login.</p><p></p><p><strong>Proxy:</strong></p><p>In the current setup EFS runs in a proxy setup. Because of that the proxy has to be configured in the IAM config. But the URL also has to be whitelisted in the proxy. Otherwise EFS cannot reach Okta.</p><ac:task-list>\n<ac:task>\n<ac:task-id>3</ac:task-id>\n<ac:task-status>incomplete</ac:task-status>\n<ac:task-body><span class=\"placeholder-inline-tasks\"><ac:link><ri:user ri:userkey=\"8a7f808668865ec601689383d2890377\"></ri:user></ac:link>  please provide more details</span></ac:task-body>\n</ac:task>\n</ac:task-list><p></p>",
    "user_segment_ids": [
        360000084973
    ]
}