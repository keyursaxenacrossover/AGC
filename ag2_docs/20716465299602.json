{
    "id": 20716465299602,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/20716465299602.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20716465299602-Identity-Provider-Setup",
    "author_id": 369584192734,
    "comments_disabled": false,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20714711445138,
    "created_at": "2024-08-12T19:06:08Z",
    "updated_at": "2024-08-28T08:37:10Z",
    "name": "Identity Provider Setup",
    "title": "Identity Provider Setup",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-08-28T08:37:07Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<h1 id=\"h_01J6C1ZF40CB4VVMN5YWMAXWGP\">Overview</h1>\n<p>This guide covers the configuration of Identity Provider routing within Okta, as well as the setup processes for both OpenID Connect and SAML Identity Providers. Identity Provider routing is crucial for ensuring that users are directed to the correct Identity Provider based on their email domain.</p>\n<p> </p>\n<ul>\n<li><a href=\"#h_01J6BZ7G4VSR5YH32YVAJ00SYH\">Configure Identity Provider Routing</a></li>\n<li><a href=\"#h_01J6BZBVNDJCA6JCKN69FGJWRB\">Open ID Connect Setup</a></li>\n<li><a href=\"#h_01J6BZJRXZ70EWV8158D2V6DTF\">SAML Provider Setup</a></li>\n<li><a href=\"#h_01J6C1WMWCKJVBQA8PTJAB7EDE\">Configure Profile Mapping</a></li>\n</ul>\n<h2 id=\"h_01J6BZ7G4VSR5YH32YVAJ00SYH\">Configure Identity Provider Routing</h2>\n<p>In order for users to reach their Identity Provider a routing has to be configured which routes users based on their email domain to their respective Identity Provider.</p>\n<p><strong>Step 1</strong>: Navigate to Routing Rules</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773957394\" alt=\"Screenshot_2019-12-03 Questback - Identity Providers.png\"></p>\n<h1 id=\"header-1\">Step 2: Add Identity Provider Routing rule</h1>\n<p><strong>Values:</strong></p>\n<p>Rule Name: see <a href=\"https://qbdocs.atlassian.net/wiki/spaces/IAM/pages/1064829097/Naming+conventions+in+Okta\">Naming conventions in Okta</a></p>\n<p>User matches:</p>\n<ul>\n<li>\n<p>Select: Domain list on login</p>\n</li>\n</ul>\n<p>Do NOT include the @ as shown in the screenshot - We will update it soon</p>\n<ul>\n<li>\n<p>Input: Domain that should be used for that IdP</p>\n</li>\n</ul>\n<p>Use this identity provider: Select the above created Identity Provider</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773957010\" alt=\"Screenshot_2019-12-03 Questback - Identity Providers(1).png\"></p>\n<p> </p>\n<p> </p>\n<h2 id=\"h_01J6BZBVNDJCA6JCKN69FGJWRB\">Open ID Connect Setup</h2>\n<p>Open ID Connect (OIDC) Identity Providers are preferred over SAML due to a more simple setup.</p>\n<h1 id=\"01J6BZJ57F4MXD3C321YHWXRA6\">Prerequisites:</h1>\n<p>The OIDC provider should send all necessary information in a token request. The mandatory fields are</p>\n<ul>\n<li>\n<p>email address</p>\n</li>\n<li>\n<p>first name</p>\n</li>\n<li>\n<p>last name</p>\n</li>\n</ul>\n<p>A domain (or domains) for routing purposes should be known (with regards to the email-address domain). Otherwise the IdP could not be used as intended.</p>\n<p>A client ID and a client secret have to be provided by the identity provider. And our redirect URI has to be applied to that client ID and client secret.</p>\n<p>A discovery-document/well-known-document have to be provided. also see OIDC Federation</p>\n<p>If the customer uses Azure AD this URL can be used with the proper customer domain:</p>\n<p><a href=\"https://login.microsoftonline.com/tivian.com/v2.0/.well-known/openid-configuration\">https://login.microsoftonline.com/tivian.com/v2.0/.well-known/openid-configuration</a></p>\n<p> </p>\n<h2 id=\"header-3\">Step 1: Navigate to Identity Providers</h2>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773958034\" alt=\"Screenshot_2019-11-29 Questback - Dashboard.png\"></p>\n<p> </p>\n<h3 id=\"header-5\">Step 2: Add a new Open ID Connect Identity Provider</h3>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773959570\" alt=\"Screenshot_2019-11-29 Questback - Identity Providers.png\"></p>\n<h3 id=\"header-6\">Step 3: Provide basic client information</h3>\n<p><strong>Values:</strong></p>\n<p>Name: see Naming conventions in Okta</p>\n<p>Client ID: this will be provided by the client’s IdP</p>\n<p>Client Secret: this will be provided by the client’s IdP</p>\n<p>Scopes:</p>\n<ul>\n<li>\n<p>always necessary: email, openid, profile</p>\n</li>\n<li>\n<p>there might be custom scopes for this specific IdP</p>\n</li>\n</ul>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012826921362\" alt=\"Screenshot_2019-11-29 Questback - Identity Providers(1).png\"></p>\n<p> </p>\n<h3 id=\"header-7\">Step 4: Configure Endpoints</h3>\n<p><strong>Values:</strong></p>\n<p>Alle values here refer to the well-known/discovery-document. They could just be copied.</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773961362\" alt=\"Screenshot_2019-11-29 Questback - Identity Providers(2).png\"></p>\n<p> </p>\n<h3 id=\"header-8\">Step 5: Configure advanced settings</h3>\n<p><strong>Values:</strong></p>\n<p>IdP Username: Usually that should always be “idpuser.email”. To prevent unexpected cases simply lowercase this value.</p>\n<p>If no match is found: “Creat enew user (JIT)” should be provided.</p>\n<p>Group Assignments: “Assign to specific groups”</p>\n<p>Specific Groups: The group that was created for that tenant.</p>\n<p>Update attributes for existing users: has to be switched <strong>off</strong></p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773963282\" alt=\"Screenshot_2019-11-29 Questback - Identity Providers(3).png\"></p>\n<p> </p>\n<h3 id=\"header-9\">Step 6: Navigate to the Identity Provider</h3>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012826925714\" alt=\"Screenshot_2019-11-29 Questback - Identity Providers(4).png\"></p>\n<h3 id=\"header-10\">Step 7: Check Redirect Domain</h3>\n<p>The domain should match the domain that was configured for the redirect URI in the client’s IdP</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773965714\" alt=\"Screenshot_2019-11-29 Questback - Identity Providers(5).png\"></p>\n<h3 id=\"header-11\">Step 8: Routing Rules</h3>\n<p>see and follow instructions at: Configure Identity Provider Routing</p>\n<h3 id=\"header-12\">Step 9: Navigate to Profile Mapping</h3>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773967122\" alt=\"Screenshot_2019-12-12 Questback - Identity Providers.png\"></p>\n<h3 id=\"header-13\">Step 10: Adapt Profile Attributes</h3>\n<p>Profile attributes depend on the external Identity Provider that is federated. This is an example for an Azure AD federation.</p>\n<p>At least the following values have to be present:</p>\n<ul>\n<li>\n<p>First Name</p>\n</li>\n<li>\n<p>Last Name</p>\n</li>\n<li>\n<p>Email</p>\n</li>\n</ul>\n<p>They can have different names (like “given_name” in the example) but they should have the same meaning.</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012826932754\" alt=\"Screenshot_2019-12-12 Questback - Universal Directory.png\"></p>\n<h3 id=\"header-14\">Step 11: Configure Profile Mappings</h3>\n<p>also see: <a href=\"https://help.okta.com/en/prod/Content/Topics/Directory/About_Universal_Directory.htm\">https://help.okta.com/en/prod/Content/Topics/Directory/About_Universal_Directory.htm</a></p>\n<p>The example might differ based upon the step before.</p>\n<p>The following values have to be mapped. Additional ones can also be mapped but will not have an effect (property names are on the right side in the image).</p>\n<p> </p>\n<h3 id=\"header-15\">Values:</h3>\n<p>login: String.toLowerCase(appuser.email)</p>\n<p>firstName: appuser.given_name</p>\n<p>lastName: appuser.family_name</p>\n<p>email: String.toLowerCase(appuser.email)</p>\n<p>emailDomain: String.substringAfter(appuser.email, \"@\")</p>\n<p>Email addresses should be lower-cased to avoid conflicts later on.</p>\n<p>Email domain will always get created when synced from EFS but in the JIT case it should also be set.</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012774001170\" alt=\"Screenshot_2019-12-12 Questback - Universal Directory(1).png\"></p>\n<p> </p>\n<h3 id=\"header-16\">Step 12: Create Routing Rule</h3>\n<p>Configure Identity Provider Routing</p>\n<p> </p>\n<h2 id=\"h_01J6BZJRXZ70EWV8158D2V6DTF\">SAML Provider Setup</h2>\n<p>Please check the<a href=\"https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20716926867858-SAML-Provider-Setup\"> SAML Provider Setup</a> article for details.</p>\n<p> </p>\n<h2 id=\"h_01J6C1WMWCKJVBQA8PTJAB7EDE\">Configure Profile Mapping</h2>\n<h3 id=\"01J6C1X1HXC217NFAJ7F7V0K71\">Step 1: Navigate to Profile Editor</h3>\n<p>Click on Edit Profile of the created Identity Provider</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773973778\" alt=\"Screenshot_2019-12-12 Questback - Identity Providers.png\"></p>\n<h3 id=\"01J6C1X1HXGXQ5ABBKM7KJVJ1C\">Step 2: Check Attributes in Profile Editor</h3>\n<p>Check that the necessary attributes are set. Especially the following are important:</p>\n<ul>\n<li>\n<p>SAML Subject Name ID</p>\n</li>\n<li>\n<p>First Name</p>\n</li>\n<li>\n<p>Last Name</p>\n</li>\n<li>\n<p>Email</p>\n</li>\n</ul>\n<p>They should all be required (that can be checked by clicking the pen or info icon).</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773975058\" alt=\"Screenshot_2019-12-12 Questback - Universal Directory(2).png\"></p>\n<h3 id=\"01J6C1X1HXP7GY4EBJZRFCDNK5\">Step 3: Adapt Profile Mappings</h3>\n<p>also see: <a href=\"https://help.okta.com/en/prod/Content/Topics/Directory/About_Universal_Directory.htm\">https://help.okta.com/en/prod/Content/Topics/Directory/About_Universal_Directory.htm</a></p>\n<p>The profile mappings should lowercase email-addresses to prevent conflicts later on.</p>\n<p> </p>\n<p><strong>Values (property names are on the right side in the picture):</strong></p>\n<p><strong>login</strong>: <code>String.toLowerCase(appuser.subjectNameId)</code></p>\n<p><strong>firstName</strong>: <code>appuser.firstName</code></p>\n<p><strong>lastName</strong>: <code>appuser.lastName</code></p>\n<p><strong>email</strong>: <code>String.toLowerCase(appuser.subjectNameId)</code></p>\n<p>[optional] <strong>mobilePhone</strong>: <code>appuser.mobilePhone</code></p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012773975954\" alt=\"Screenshot_2019-12-12 Questback - Universal Directory.png\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21012826945554\" alt=\"Screenshot_2019-12-12 Questback - Universal Directory(1).png\"></p>\n<p> </p>\n<p> </p>",
    "user_segment_ids": [
        360000084973
    ]
}