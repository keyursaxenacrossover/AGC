{
    "id": 20370634292498,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/20370634292498.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20370634292498-AD-FS-3-0-on-Windows-Server-2012-R2",
    "author_id": 369584192734,
    "comments_disabled": true,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20259399705746,
    "created_at": "2024-07-25T16:17:44Z",
    "updated_at": "2024-08-28T10:01:54Z",
    "name": "AD FS 3.0 on Windows Server 2012 R2",
    "title": "AD FS 3.0 on Windows Server 2012 R2",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-07-26T08:20:21Z",
    "user_segment_id": null,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<h1 id=\"h_01HGKSMPRS9JVGC6E9EA3DB98K\" class=\"wysiwyg-text-align-justify\">Overview</h1>\n<p class=\"wysiwyg-text-align-justify\">This article provides a comprehensive guide on configuring AD FS 3.0 on Windows Server 2012 R2 for SAML federation with Okta. It covers the prerequisites, configuration steps, and claim rules necessary for successful integration.</p>\n<p class=\"wysiwyg-text-align-justify\"> </p>\n<h1 id=\"h_01HGKSMPRSYYE7GMM7DZ0VCKXK\" class=\"wysiwyg-text-align-justify\">Information</h1>\n<p class=\"wysiwyg-text-align-justify\">This guide focuses on setting up AD FS 3.0 on Windows Server 2012 R2 to work with SAML federation. It includes detailed steps for creating a Relying Party Trust and configuring the required claim rules.</p>\n<ul class=\"wysiwyg-text-align-justify\">\n<li><a href=\"#prerequisites\">Prerequisites</a></li>\n<li><a href=\"#configuration-in-ad-fs\">Configuration in AD FS</a></li>\n</ul>\n<p class=\"wysiwyg-text-align-justify\"> </p>\n<p class=\"wysiwyg-text-align-justify\">AD FS will be used in combination with a SAML federation in that version. Prefer an OIDC federation in newer versions.</p>\n<table class=\"wysiwyg-text-align-justify\" style=\"width: 699px;\" border=\"1\" data-layout=\"default\">\n<colgroup> <col style=\"width: 340.0px;\"> <col style=\"width: 340.0px;\"> </colgroup>\n<tbody>\n<tr>\n<td style=\"width: 283.681px;\">\n<p>OICD Federation</p>\n<p>(Metadata)</p>\n</td>\n<td style=\"width: 391.979px;\">\n<p><a href=\"https://sso.questback.com/FederationMetadata/2007-06/FederationMetadata.xml\">https://sso.questback.com/FederationMetadata/2007-06/FederationMetadata.xml</a></p>\n</td>\n</tr>\n</tbody>\n</table>\n<h3 class=\"wysiwyg-text-align-justify\"> </h3>\n<h3 id=\"prerequisites\" class=\"wysiwyg-text-align-justify\"><strong>Prerequisites</strong></h3>\n<ol class=\"wysiwyg-text-align-justify\">\n<li>\n<p>The Server has to be part of the target Active Directory Domain</p>\n</li>\n<li>\n<p>The Server Role “Active Directory Federation Services” has to be installed and configured on the server.</p>\n</li>\n<li>\n<p>The three parts “Install a server SSL certificate”, “Install the AD FS server role” and “Configure the federation server” under Step 2 of the Microsoft documentation are quite helpful.</p>\n</li>\n</ol>\n<table class=\"wysiwyg-text-align-justify\" border=\"1\" data-layout=\"default\">\n<colgroup> <col style=\"width: 340.0px;\"> <col style=\"width: 340.0px;\"> </colgroup>\n<tbody>\n<tr>\n<td style=\"width: 263.542px;\">\n<p>Microsoft Documentation</p>\n</td>\n<td style=\"width: 413.125px;\">\n<p><a href=\"https://docs.microsoft.com/de-de/windows-server/identity/ad-fs/deployment/set-up-the-lab-environment-for-ad-fs-in-windows-server-2012-r2#step-2-configure-the-federation-server-adfs1-by-using-device-registration-service\">https://docs.microsoft.com/de-de/windows-server/identity/ad-fs/deployment/set-up-the-lab-environment-for-ad-fs-in-windows-server-2012-r2#step-2-configure-the-federation-server-adfs1-by-using-device-registration-service</a></p>\n</td>\n</tr>\n</tbody>\n</table>\n<p class=\"wysiwyg-text-align-justify\">There is no further configuration needed in AD FS to enable SAML authentication.</p>\n<p class=\"wysiwyg-text-align-justify\">To successfully create a SAML federation between AD FS and Okta there are a few fields that are required by our Okta solution. The AD FS has to provide an email address, first name, and last name as well as an email address as NameID.</p>\n<p class=\"wysiwyg-text-align-justify\"> </p>\n<h3 id=\"configuration-in-ad-fs\" class=\"wysiwyg-text-align-justify\"><strong>Configuration in AD FS</strong></h3>\n<p class=\"wysiwyg-text-align-justify\">The steps might change with regard to the version and server version. They might also change with respect to the specific fields that are available in the actual AD FS instance.</p>\n<p class=\"wysiwyg-text-align-justify\"><strong>Step 1: Create a Relying Party Trust</strong></p>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015039155986\" alt=\"image-20200106-121635.png\"></p>\n<p class=\"wysiwyg-text-align-justify\">In the second step of the configuration wizard, the information can and should be imported via a metadata.xml file provided by Okta. This contains all the information needed to complete the wizard.</p>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015039159698\" alt=\"image-20200106-121918.png\"></p>\n<p class=\"wysiwyg-text-align-justify\"><strong>Step 2: Create Claim Rules</strong></p>\n<p class=\"wysiwyg-text-align-justify\">All claim rules for the formerly created Party Trust can be found here:</p>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015069187346\" alt=\"image-20200106-122205.png\"></p>\n<p class=\"wysiwyg-text-align-justify\">New rules can be created by clicking on “Add Rule…”:</p>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015039181202\" alt=\"image-20200106-123400.png\"></p>\n<p class=\"wysiwyg-text-align-justify\"> </p>\n<p class=\"wysiwyg-text-align-justify\">The following three rules have to be created:</p>\n<ul class=\"wysiwyg-text-align-justify\">\n<li>\n<p>Attribute claims from AD</p>\n</li>\n</ul>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015069191186\" alt=\"image-20200106-122823.png\"></p>\n<ul class=\"wysiwyg-text-align-justify\">\n<li>\n<p>Pass E-Mail Claims</p>\n</li>\n</ul>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015039178898\" alt=\"image-20200106-122959.png\"></p>\n<ul class=\"wysiwyg-text-align-justify\">\n<li>\n<p>Email to NameID</p>\n</li>\n</ul>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015069201810\" alt=\"image-20200106-123624.png\"></p>\n<p class=\"wysiwyg-text-align-justify\"><strong>Step 3: Check the order of the claim rules (important!)</strong></p>\n<p class=\"wysiwyg-text-align-justify\"><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21015069210514\" alt=\"image-20200106-123756.png\"></p>\n<p class=\"wysiwyg-text-align-justify\"> </p>\n<h1 id=\"h_01HGKSMPRSER9ENY5QWWRZZ863\" class=\"wysiwyg-text-align-justify\">FAQ</h1>\n<h3 id=\"faq1\" class=\"wysiwyg-text-align-justify\">What version of AD FS is covered in this guide?</h3>\n<p class=\"wysiwyg-text-align-justify\">This guide covers AD FS 3.0 on Windows Server 2012 R2.</p>\n<h3 id=\"faq2\" class=\"wysiwyg-text-align-justify\">Is additional configuration needed in AD FS for SAML authentication?</h3>\n<p class=\"wysiwyg-text-align-justify\">No, there is no further configuration needed in AD FS to enable SAML authentication beyond what is described in this guide.</p>\n<h3 id=\"faq3\" class=\"wysiwyg-text-align-justify\">What information does AD FS need to provide for Okta integration?</h3>\n<p class=\"wysiwyg-text-align-justify\">AD FS needs to provide email address, first name, last name, and an email address as NameID for successful integration with Okta.</p>\n<p class=\"wysiwyg-text-align-justify\"> </p>",
    "user_segment_ids": []
}