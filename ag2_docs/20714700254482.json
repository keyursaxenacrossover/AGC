{
    "id": 20714700254482,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/20714700254482.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20714700254482-Tivian-Access-IAM-with-Okta",
    "author_id": 369584192734,
    "comments_disabled": false,
    "draft": true,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20714530860562,
    "created_at": "2024-08-12T16:56:13Z",
    "updated_at": "2024-08-12T16:56:15Z",
    "name": "Tivian Access: IAM with Okta",
    "title": "Tivian Access: IAM with Okta",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-08-12T16:56:15Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<p><b>Original Confluence URL:</b> <a href=\"https://qbdocs.atlassian.net/wiki/spaces/TS/pages/1183678595\">https://qbdocs.atlassian.net/wiki/spaces/TS/pages/1183678595</a> - please cross-check the quality of the ZD article with the Confluence counterpart and remove this line before publishing the ZD article</p>\n\n<h2>Table of Contents</h2>\n<ul class=\"toc\">\n<ul>\n<li><a href=\"#header-1\">Identity and Access Management</a></li>\n<ul>\n<li><a href=\"#header-3\">Documentation:</a></li>\n<ul>\n<li><a href=\"#header-5\">Link to Okta Web Admin Console:</a></li>\n</ul>\n<li><a href=\"#header-7\">Setup</a></li>\n<li><a href=\"#header-8\">Deactivation DB</a></li>\n<li><a href=\"#header-9\">AWS Migration</a></li>\n<li><a href=\"#header-10\">Installations with SSO</a></li>\n<li><a href=\"#header-11\">Troubleshooting</a></li>\n</ul>\n</ul>\n</ul><h1 id=\"header-1\">Identity and Access Management</h1><h2 id=\"header-3\">Documentation:</h2><p><ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"Operation\" ri:space-key=\"IAM\" ri:version-at-save=\"1\"></ri:page><ac:link-body>Operation</ac:link-body></ac:link> </p><ac:rich-text-body><p>Bypass user root for installations has email address: <a href=\"mailto:noreply@questback.com\">noreply@questback.com</a> or <a href=\"mailto:efs-root@questback.com\">efs-root@questback.com</a> or <a href=\"mailto:efs-root@globalpark.com\">efs-root@globalpark.com</a>, root password remains (if none of those: table “users” where uid = 1)</p>\n<p>Standard link: <a href=\"https://beat.customervoice360.com/iam/admin/auth/login/bypass\">https://ab1234.customervoice360.com/iam/admin/auth/login/bypass</a></p></ac:rich-text-body><h3 id=\"header-5\">Link to Okta Web Admin Console:</h3><p><a href=\"https://questback-admin.okta.com/admin/settings/account\">https://questback-admin.okta.com/admin/settings/account</a></p><p><a href=\"https://tivian-admin.okta.com/admin/settings/account\">https://tivian-admin.okta.com/admin/settings/account</a></p><h2 id=\"header-7\">Setup</h2><div class=\"expand-macro\">\n<h4 string=\"Checkliste\"></h4>\n<pre><code class=\"language-text\">IAM\n\t[] add module 'IdentityAccessManager'\n\t[] run healself\n\t[] configure force_ssl\n\n[] IDP (once per customer)\n\t[] set up IdP with customer\n\n[] Set up Okta\n\t[]Authorisation Server Setup\n\t\t[] Audience: api://[clientname]-&gt;iam_audience\n\t\t[] Metadata URL-&gt; iam_well_known_url\n\n\t[] Group Setup\n\t\t[] Group ID-&gt; iam_user_group_id\n\t\t(The ID of the groupd specified in Okta for the customer, not the installation)\n\n\t[] Sign on Policy\n\t\t[] use Documentaion\n\n\t[] API Token Setup\n\t\t[] create token with okta user iam@questback.com\n\t\t[] store token in keepass (notes section)\n\n[] IAM EFS Admin\n\tOkta\n\t[] group for EFS instance\n\t\t[]groupid-&gt;iam_client_group_id\n\n\t[]Application\n\t\t[] login URL&lt;-&gt;EFS\n\t\t[] logout URL&lt;-&gt;EFS\n\t\t[] Client id -&gt; iam_client_id\n\t\t[] Client secret -&gt; iam_client_secret\n\tEFS\n\t[] root-bypass *optional\n\t[] iam_federated_domains (in case idp exists, always add tivian.com)\n\t[] iam_idp_id *optional to skip Okta fpr customer IdP\n\t[] proxy: http://squid.global-services.svc.cluster.local:8080\n\t[] iam_unique_customer_name (pick this once at the beginning of the process)\n\n[]IAM EFS Portals\n\tOkta\n\t[] create trusted origin\n\thttps://qbdocs.atlassian.net/wiki/spaces/IAM/pages/1077182620/Portals+Setup\n\t\t\n\tEFS\n\t[] add portal iam_sso_modules\n\t[] configure iam_panelist_sync (check federated domains!)\n\n\t[] run migration Script cd www &amp;&amp; php support/iam/migration.php\n\t[] module active true (ONLY IF EVERYTHING WORKS, LOCKS PEOPLE OUT!!!)</code></pre>\n</div><p></p><h2 id=\"header-8\">Deactivation DB</h2><p>How to deactivate Tivian Access if the bypass URL does not work:</p><p></p><pre><code class=\"language-sql\">SELECT * from config_variables where name ='iam_module_active';\nUPDATE config_variables set value='b:0;' where name ='iam_module_active';</code></pre><p></p><h2 id=\"header-9\">AWS Migration</h2><p>Query to set iam_proxy_url after migration:</p><pre><code class=\"language-sql\">REPLACE INTO config_variables SET name='iam_proxy_url', module='IdentityAccessManager', definition='O:15:\\\"Efs_Config_Item\\\":5:{s:20:\\\"\\0Efs_Config_Item\\0key\\\";s:13:\\\"iam proxy_url\\\";s:22:\\\"\\0Efs_Config_Item\\0value\\\";O:23:\\\"Efs_Config_Value_String\\\":1:{s:8:\\\"\\0*\\0value\\\";s:51:\\\"http://squid.global-services.svc.cluster.local:8080\\\";}s:28:\\\"\\0Efs_Config_Item\\0description\\\";s:46:\\\"Set proxy if necessary. E.q. http://proxy:8080\\\";s:35:\\\"\\0Efs_Config_Item\\0modificationStatus\\\";b:1;s:25:\\\"\\0Efs_Config_Item\\0noteHtml\\\";s:0:\\\"\\\";}', value='s:51:\\\"http://squid.global-services.svc.cluster.local:8080\\\";', is_standard=1</code></pre><h2 id=\"header-10\">Installations with SSO</h2><p><ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"SSO Installations\" ri:version-at-save=\"22\"></ri:page><ac:link-body>SSO Installations</ac:link-body></ac:link> </p><p></p><p>Remove Okta?</p><p>Access Policies alle löschen bevor man Auth server löschen kann</p><p>Bisher kann das Modul nicht mehr versteckt werden, wenn die Healself einmal gelaufen ist.</p><h2 id=\"header-11\">Troubleshooting</h2><p><ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"Debugging Cases\" ri:space-key=\"IAM\" ri:version-at-save=\"1\"></ri:page><ac:link-body>Debugging Cases</ac:link-body></ac:link> </p><p>In order to be able to give a QB-Account permissions for Okta Web Admin, the user has to login once via the link above and their AD user/password. The account is then created in Okta and a Super User (Mathias/Pascal) can grant permissions for Okta Web Admin. We only need Installation rights.</p>",
    "user_segment_ids": [
        360000084973
    ]
}