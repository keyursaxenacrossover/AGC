{
    "id": 21741183591314,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/21741183591314.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/21741183591314-Accessing-and-Querying-Grafana-Logs-A-Comprehensive-Guide",
    "author_id": 1904316023094,
    "comments_disabled": false,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20234751255186,
    "created_at": "2024-10-02T15:08:13Z",
    "updated_at": "2024-12-10T12:16:09Z",
    "name": "Accessing and Querying Grafana Logs: A Comprehensive Guide",
    "title": "Accessing and Querying Grafana Logs: A Comprehensive Guide",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-12-10T12:16:09Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [
        "Cron Jobs",
        "Grafana",
        "Azure AD",
        "Nginx Logs",
        "Loki",
        "Log Querying"
    ],
    "body": "<h1 id=\"h_01J96WD0266X4195DQ79HW9DJA\">Overview</h1>\n<p>This article provides guidance on how to access and query Grafana logs. Grafana is a visual interface used to monitor the performance and status of processes such as cron jobs and server logs. Users may need to access and query these logs for various reasons, such as checking the history and status of cron jobs, examining Nginx logs, or exploring specific logs or events.</p>\n<h1 id=\"h_01J96WD0266DGFBDGGKA607AT9\">Solution</h1>\n<h2 id=\"h_01J96WD0262B1GNSX5TC5CK8J3\">Accessing Grafana</h2>\n<ul>\n<li>\n<p><strong>Log in to Grafana:</strong> Use your <span style=\"color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;\">DevfactoryÂ </span>AD credentials to log in to one of the Grafana instances, depending on your environment:</p>\n<ul>\n<li><strong style=\"box-sizing: border-box; font-weight: bolder; color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><a style=\"box-sizing: border-box; background: #fff7ed; color: #1f73b7; text-decoration: none; padding: 0px; font-size: 14px; vertical-align: baseline; line-height: inherit; font-family: system-ui, -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, Oxygen-Sans, Ubuntu, Cantarell, ' Helvetica Neue' , Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; white-space: normal;\" href=\"https://grafana.prod-de-03.customervoice360.com/login\" rel=\"noopener noreferrer\">grafana.prod-de-03</a></strong></li>\n<li><strong style=\"box-sizing: border-box; font-weight: bolder; color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><a style=\"box-sizing: border-box; background: #fff7ed; color: #1f73b7; text-decoration: none; padding: 0px; font-size: 14px; vertical-align: baseline; line-height: inherit; font-family: system-ui, -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, Oxygen-Sans, Ubuntu, Cantarell, ' Helvetica Neue' , Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; white-space: normal;\" href=\"https://grafana.prod-us-03.customervoice360.com/login\" rel=\"noopener noreferrer\">grafana.prod-us-03</a></strong></li>\n<li><strong style=\"box-sizing: border-box; font-weight: bolder; color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><a style=\"box-sizing: border-box; background: #fff7ed; color: #1f73b7; text-decoration: none; padding: 0px; font-size: 14px; vertical-align: baseline; line-height: inherit; font-family: system-ui, -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, Oxygen-Sans, Ubuntu, Cantarell, ' Helvetica Neue' , Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; white-space: normal;\" href=\"https://grafana.sandbox-de-02.customervoice360.com/login\" rel=\"noopener noreferrer\">grafana.sandbox-de-02</a></strong></li>\n<li><strong style=\"box-sizing: border-box; font-weight: bolder; color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><a style=\"box-sizing: border-box; background: #fff7ed; color: #1f73b7; text-decoration: none; padding: 0px; font-size: 14px; vertical-align: baseline; line-height: inherit; font-family: system-ui, -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, Oxygen-Sans, Ubuntu, Cantarell, ' Helvetica Neue' , Arial, sans-serif; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; white-space: normal;\" href=\"https://grafana.bofa-us-01.customervoice360.com/login\" rel=\"noopener noreferrer\">grafana.bofa-us-01</a></strong></li>\n</ul>\n</li>\n<li>\n<p><strong>Navigating Logs:</strong> After logging in:</p>\n<ul>\n<li>Go to the \"<strong>Explore</strong>\" section in the side menu.</li>\n<li>Choose <strong>Loki</strong> as the data source for querying logs.</li>\n<li>Start building queries to explore specific logs or events.</li>\n</ul>\n</li>\n</ul>\n<div class=\"group/conversation-turn relative flex w-full min-w-0 flex-col agent-turn\">\n<div class=\"flex-col gap-1 md:gap-3\">\n<div class=\"flex max-w-full flex-col flex-grow\">\n<div class=\"min-h-8 text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words [.text-message+&amp;]:mt-5\" dir=\"auto\" data-message-author-role=\"assistant\" data-message-id=\"cd84dbb5-b534-45ab-b199-3720dc83f6cd\">\n<div class=\"flex w-full flex-col gap-1 empty:hidden first:pt-[3px]\">\n<div class=\"markdown prose w-full break-words dark:prose-invert light\">\n<h4 id=\"h_01J96XFXM2C1JDEDF83RSZNMK8\"><strong>Possible Uses of Grafana in DXI</strong></h4>\n<ol>\n<li>\n<p><strong>Checking Cronjob History and Status</strong>: (as per the article <span style=\"color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;\"><a href=\"https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/21236040590994-Troubleshooting-Mail-Delivery-Issues-A-Comprehensive-Guide#h_01J79604RA91E8BMHTQ4XWZ7WB\">Checking Cron Jobs in Grafana</a>)</span></p>\n<ul>\n<li>\n<p>Monitor cron jobs such as <code style=\"font-size: 15px;\">snailmail</code> and <code style=\"font-size: 15px;\">jobmaker</code> (which initiates <code style=\"font-size: 15px;\">pickupmailNotifications</code>).</p>\n</li>\n<li>Use this when emails are stuck in the queue or there is a significant delay in email delivery.</li>\n</ul>\n</li>\n<li>\n<p><strong>Checking Nginx Logs</strong>:</p>\n<ul>\n<li>Nginx logs provide details on web requests, including IP addresses, request methods, response statuses, etc... This can help track down specific customer interactions or performance issues.</li>\n</ul>\n</li>\n<li>\n<strong>Checking HPA (Horizontal Pod Autoscaler) for performance reasons</strong>\n<ul>\n<li>\n<code>Dashboards &gt; Legacy &gt; EFS Single Installation &gt; choose Installation &gt; HPA</code><br>Checking HPA pool section (for horizontal scaling)</li>\n<li>Expected result from a prod installation:<br style=\"box-sizing: border-box; line-height: inherit;\"><span style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; box-sizing: border-box; line-height: inherit; opacity: 1;\"><img style=\"vertical-align: baseline; border: 0px; margin: 0px; padding: 0px; outline: 0px; background: transparent; box-sizing: border-box; line-height: inherit; object-fit: scale-down; aspect-ratio: auto; inline-size: auto; max-block-size: 75dvb; block-size: auto; max-width: 100%; max-inline-size: 100%;\" src=\"https://central-supportdesk.zendesk.com/attachments/token/6PpENWKe3OC0D5goYLb6wpSEh/?name=image.png\"></span>\n</li>\n<li>This result for example indicates a periodic upscaling, so we might need to check the reasons and maybe increase resources:<br><span style=\"margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: baseline; background: transparent; box-sizing: border-box; line-height: inherit; opacity: 1;\"><img style=\"vertical-align: baseline; border: 0px; margin: 0px; padding: 0px; outline: 0px; background: transparent; box-sizing: border-box; line-height: inherit; object-fit: scale-down; aspect-ratio: auto; inline-size: auto; max-block-size: 75dvb; block-size: auto; max-width: 100%; max-inline-size: 100%;\" src=\"https://central-supportdesk.zendesk.com/attachments/token/2T7e0OY2vI4RWfxQGsz4zaQCD/?name=image.png\"></span>\n</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"h_01J96XFXM2SWJH5JKAR0HRYXZM\"><strong>Querying Logs in Grafana (Loki)</strong></h4>\n<p><strong>Basic Query Structure:</strong> Loki follows a query syntax similar to Prometheus, but instead of metrics, it operates on log data. Each log entry is associated with labels, which can be used to filter specific logs.</p>\n<p><strong>Common Loki Query Example:</strong> To check logs for an Nginx container in a specific namespace, you can use:</p>\n<div class=\"dark bg-gray-950 contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative\">\n<div class=\"overflow-y-auto p-4\" dir=\"ltr\"><code class=\"!whitespace-pre hljs language-logql\">{namespace=\"av5081\", container=\"nginx\"} !~ `iLert|Prometheus/|kube-probe` |= `/uc`\n</code></div>\n</div>\n<p><strong>Explanation:</strong></p>\n<ul>\n<li>\n<code>{namespace=\"av5081\", container=\"nginx\"}</code> filters logs based on the <code>namespace</code> and <code>container</code> labels.</li>\n<li>\n<code>!~</code> excludes certain logs (e.g., iLert, Prometheus, kube-probe).</li>\n<li>\n<code>|=</code> looks for logs containing <code>/uc</code> in the message body.</li>\n</ul>\n<p><strong>Other Example:</strong></p>\n<ul>\n<li><strong><span style=\"color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;\">Example ofÂ </span><a style=\"box-sizing: border-box; background-color: #ffffff; color: #1f73b7; text-decoration: underline; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal;\" href=\"https://grafana.prod-de-03.customervoice360.com/explore?schemaVersion=1&amp;panes=%7B%22sks%22:%7B%22datasource%22:%22P8E80F9AEF21F6940%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bnamespace%3D%5C%22tr9043%5C%22,%20job%3D%5C%22tr9043%2Fnginx%5C%22%7D%20%21~%20%60PHP%20Warning%60%20%7C~%20%6082%5C%5C.68%5C%5C.16%5C%5C.244%7C91%5C%5C.149%5C%5C.202%5C%5C.234%7C81%5C%5C.135%5C%5C.6%5C%5C.171%7C2%5C%5C.217%5C%5C.33%5C%5C.83%7C81%5C%5C.129%5C%5C.170%5C%5C.194%7C81%5C%5C.157%5C%5C.66%5C%5C.79%7C92%5C%5C.9%5C%5C.234%5C%5C.52%7C81%5C%5C.174%5C%5C.144%5C%5C.193%60%20%7C~%20%60%60%22,%22queryType%22:%22range%22,%22datasource%22:%7B%22type%22:%22loki%22,%22uid%22:%22P8E80F9AEF21F6940%22%7D,%22editorMode%22:%22builder%22%7D%5D,%22range%22:%7B%22from%22:%221718668800000%22,%22to%22:%221718841599000%22%7D%7D%7D&amp;orgId=1\">a Grafana Loki query</a></strong></li>\n<li>\n<div class=\"dark bg-gray-950 contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative\" style=\"box-sizing: border-box; color: #212529; font-family: -apple-system, BlinkMacSystemFont, ' Segoe UI' , Roboto, ' Helvetica Neue' , Arial, sans-serif, ' Apple Color Emoji' , ' Segoe UI Emoji' , ' Segoe UI Symbol' , ' Noto Color Emoji' font-size:16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: #ffffff; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\">\n<div class=\"overflow-y-auto p-4\" dir=\"ltr\" style=\"box-sizing: border-box; padding: 1.5rem !important;\">\n<code class=\"!whitespace-pre hljs language-loki\" style=\"box-sizing: border-box; font-family: SFMono-Regular, Menlo, Monaco, Consolas, ' Liberation Mono' , ' Courier New' , monospace; font-size: 14px; color: #e83e8c; word-break: break-word; background: #f7f7f7; border: 1px solid #dddddd; border-radius: 3px; padding: 0px 5px; margin: 0px 2px;\">{namespace=\"tr9043\", job=\"tr9043/nginx\"} |~ \"82.68.16.244\"</code><br style=\"box-sizing: border-box;\"><img style=\"box-sizing: border-box; border-style: none; vertical-align: middle; height: auto; max-width: 100%;\" src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21741769632658\">\n</div>\n</div>\n</li>\n<li style=\"box-sizing: border-box;\">This query fetches logs from the <code>nginx</code> job (another way to get all web requests) in the <code>tr9043</code> namespace (installation name) and filters them to only show logs that contain the IP address <code>82.68.16.244</code>\n</li>\n</ul>\n<p><strong>Additional Query Tips</strong>:</p>\n<ul>\n<li>\n<strong>Exclude unwanted logs</strong>: You can exclude log messages that are unnecessary using the <code>!~</code> operator, as shown above. For example, filter out system-related logs from Prometheus or Kubernetes probes.</li>\n<li>\n<strong>Filters</strong> can also be done via GUI by selecting text you want to include/exclude, which will automatically show a sub-menu which would allow you to either include or exclude the string from the query:<br><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21741949800082\">\n</li>\n<li>\n<strong>Use labels for precision</strong>: By specifying container names (e.g., <code>container=\"nginx\"</code>) or namespaces, you can reduce the number of irrelevant logs.</li>\n</ul>\n<p>For more advanced log querying, refer to the <a href=\"https://grafana.com/docs/loki/latest/query/\" target=\"_new\" rel=\"noopener\">Grafana Loki Query Documentation</a>.</p>\n<hr>\n<h4 id=\"h_01J96XFXM2TE4PG299K4Z8MM29\"><strong>Additional Resources for Log Manipulation:</strong></h4>\n<p>To process Grafana logs and extract bulk data from logs, you have the following options:</p>\n<ul>\n<li>Simply download the files and process via editor using RegEx search and Replace to process further via Excel</li>\n<li>If you want to find out about parsing/manipulating the displayed logs directly through Grafana, please take a look here: <a style=\"box-sizing: border-box; background-color: transparent; color: #1f73b7; text-decoration: underline;\" href=\"https://grafana.com/blog/2021/08/09/new-in-loki-2.3-logql-pattern-parser-makes-it-easier-to-extract-data-from-unstructured-logs/\">new-in-loki-2.3-logql-pattern-parser</a>\n</li>\n<li style=\"list-style-type: none;\">Â </li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<h1 id=\"h_01J96WD026JFXVNA8PM93X7TD3\">Summary</h1>\n<p>By following these steps and using the outlined queries, you can efficiently monitor and troubleshoot various system logs in Grafana, including cron jobs, web server logs, and more.</p>\n<h2 id=\"h_01J96WD026N12DCR04FG11CZVP\">FAQ</h2>\n<p>1. <strong>What is Grafana?</strong><br>Grafana is a visual interface used to monitor the performance and status of processes such as cron jobs and server logs.</p>\n<p>2. <strong>What is Loki?</strong><br>Loki is a horizontally-scalable, highly-available, multi-tenant log aggregation system inspired by Prometheus. It is used as a data source for querying logs in Grafana.</p>\n<p>3. <strong>How can I exclude unnecessary logs in Grafana?</strong><br>You can exclude unnecessary logs using the !~ operator in your query.</p>",
    "user_segment_ids": [
        360000084973
    ]
}