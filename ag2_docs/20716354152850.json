{
    "id": 20716354152850,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/20716354152850.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20716354152850-Mass-User-Sync-Migration",
    "author_id": 369584192734,
    "comments_disabled": false,
    "draft": true,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20714711445138,
    "created_at": "2024-08-12T19:02:08Z",
    "updated_at": "2024-08-12T19:02:10Z",
    "name": "Mass User Sync (Migration)",
    "title": "Mass User Sync (Migration)",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-08-12T19:02:10Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<p><b>Original Confluence URL:</b> <a href=\"https://qbdocs.atlassian.net/wiki/spaces/IAM/pages/1070137353\">https://qbdocs.atlassian.net/wiki/spaces/IAM/pages/1070137353</a> - please cross-check the quality of the ZD article with the Confluence counterpart and remove this line before publishing the ZD article</p>\n\n<h2>Table of Contents</h2>\n<ul class=\"toc\">\n<ul>\n<li><a href=\"#header-1\">Cases</a></li>\n<ul>\n<li><a href=\"#header-3\">Business Impact</a></li>\n<li><a href=\"#header-4\">Problem</a></li>\n<li><a href=\"#header-5\">Solutions</a></li>\n</ul>\n</ul>\n</ul><ac:layout><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"fixed-width\"><ac:layout-cell><h1 id=\"header-1\">Cases</h1>\n<p>Syncing users to Okta is required in some cases. In the following cases we will distinguish between the <strong>Creation </strong>of users, the <strong>Activation </strong>of users and<strong> Updates </strong>for users.</p>\n<ul>\n<li><p>Initial Sync of EFS admin users to Okta (Creation + Activation)</p></li>\n<li><p>Initial Sync of Portal users (panelists) to Okta (Creation + Activation)</p></li>\n<li><p>Import via CSV for EFS Admin users (Creation + Activation)</p></li>\n<li><p>Import via CSV for Portal users (Creation + Activation)</p></li>\n<li><p>Bulk update of users (EFS Admin + Panelists <ac:emoticon ac:emoji-fallback=\":question_mark:\" ac:emoji-id=\"atlassian-question_mark\" ac:emoji-shortname=\":question_mark:\" ac:name=\"question\"></ac:emoticon>, Update)</p></li>\n<li><p>Import panelists from Employee Project <ac:emoticon ac:emoji-fallback=\":question_mark:\" ac:emoji-id=\"atlassian-question_mark\" ac:emoji-shortname=\":question_mark:\" ac:name=\"question\"></ac:emoticon> (Creation)</p></li>\n</ul>\n<h2 id=\"header-3\">Business Impact</h2>\n<p>Also see <ac:link ac:card-appearance=\"inline\"><ri:page ri:content-title=\"Business Decisions\" ri:version-at-save=\"8\"></ri:page><ac:link-body>Business Decisions</ac:link-body></ac:link> for conditions that have an impact on the solution for our first version.</p>\n<h2 id=\"header-4\">Problem</h2>\n<p>The problem with the user migration comes down to two things:</p>\n<ul>\n<li>\n<p>Okta has API limits for API endpoints, e.g: User creation is limited to <code>600 / minute</code> </p>\n<ul><li><p>The API limit is account wide → All clients will share the API Limit</p></li></ul>\n</li>\n<li>\n<p>Users needs to be activated which <strong>could </strong>be decoupled from the creation</p>\n<ul>\n<li><p>Activating users will send out an activation mail</p></li>\n<li><p>Receiving the mail before Questback Access is working on an installation will be confusing, because the Okta account will not be useful at that moment</p></li>\n<li><p>Receiving the mail after Questback Access is working on an installation is making the installation not usable for the difference in time, because no one can login</p></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"header-5\">Solutions</h2>\n<p>To solve all cases, a mix of the following solutions may need to be done.</p>\n<p><strong>Solution 1: Limit number of users which can be imported</strong></p>\n<p>A limit will be set for EFS Admins/Panelists imports (e.g: default of 5000 users, configurable by 2nd level support). This will ensure that an import (even when throttled by the API limits) will be done in a reasonable amount of time.</p>\n<p>If a client wants to import a bigger number of users, he will receive a message telling him that he needs to contact support for this. In case a really big import is requested, we also may need to request an exception for the API limits from Okta.</p>\n<p>Bulk updates could be handled the same way.</p></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"three_equal\"><ac:layout-cell><p><strong>Pro</strong></p>\n<ul>\n<li><p>Not many clients will do really big user imports</p></li>\n<li><p>2nd level support can fine tune the threshold if needed (e.g: increase limit to 7000 users)</p></li>\n<li><p>Cheap implementation</p></li>\n<li><p>Approved by Heiko</p></li>\n</ul></ac:layout-cell><ac:layout-cell><p><strong>Contra</strong></p>\n<ul>\n<li><p>Limits current EFS functionality</p></li>\n<li><p>More work for 2nd level support in case of big imports</p></li>\n</ul></ac:layout-cell><ac:layout-cell><p><strong>Solves</strong></p>\n<ul>\n<li><p>Import via CSV for EFS Admin users</p></li>\n<li><p>Import via CSV for Portal users</p></li>\n<li><p>Bulk update of users</p></li>\n</ul></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"fixed-width\"><ac:layout-cell><p></p>\n<p><strong>Solution 2: Import Early (and request exception)</strong></p>\n<p>To understand the problem better a simple example calculation:</p>\n<p>Import 1.000.000 users - <code>600 requests/minute</code> limit</p>\n<p>1.000.000 / 600 = 1666.67 minutes / 60 = 27.78 hours</p>\n<p><strong>Note</strong>: This is not taking into consideration that also other clients may use the same API at the time and the throughput is lower (and it takes longer).</p>\n<p>It is mostly unknown how long a current user import for 1.000.000 users would take, but <ac:link><ri:user ri:userkey=\"8a7f8085680f7144016812deb4300167\"></ri:user></ac:link> estimated based on experience that it would also take up to hours.</p>\n<p>If the number of users is known before the migration, the import should be done at least x hours before activating Questback Access, where x is the estimated import duration based on the limits.</p>\n<p>In extreme cases the Okta support can be contacted to request an exception of the API limit (<a href=\"https://developer.okta.com/docs/reference/rate-limits/#requesting-exceptions\">https://developer.okta.com/docs/reference/rate-limits/#requesting-exceptions</a>)</p>\n<p>Timeline: ---(Import and Activate Users)----------------(Activate Questback Access)-------------------&gt;</p></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"three_equal\"><ac:layout-cell><p><strong>Pro</strong></p>\n<ul><li><p>No special implementation needed</p></li></ul></ac:layout-cell><ac:layout-cell><p><strong>Contra</strong></p>\n<ul>\n<li><p>Potentially long sync times</p></li>\n<li><p>Activation mails will go out (~hours) before the activation of Questback Access happens</p></li>\n<li><p>Okta may not do exceptions on a regular basis</p></li>\n</ul></ac:layout-cell><ac:layout-cell><p><strong>Solves</strong></p>\n<ul>\n<li><p>Initial Sync of EFS admin users to Okta</p></li>\n<li><p>Initial Sync of Portal users (panelists) to Okta</p></li>\n</ul></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"fixed-width\"><ac:layout-cell><p></p>\n<p><strong>Solution 2a: Do Activation Later</strong></p>\n<p>Same as Solution 2, but do not activate users directly when creating, but at a later point in time after the activation of Questback Access.</p>\n<p>Timeline: ---(Import Users)----------------(Activate Questback Access)--(Activate Users)--------------&gt;</p></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"three_equal\"><ac:layout-cell><p><strong>Pro</strong></p>\n<ul><li><p>More control about when the users will receive the activation mail</p></li></ul></ac:layout-cell><ac:layout-cell><p><strong>Contra</strong></p>\n<ul><li><p><strong>Activation will also be done via API and suffer from the same API limits</strong></p></li></ul></ac:layout-cell><ac:layout-cell><p><strong>Solves</strong></p>\n<ul>\n<li><p>Initial Sync of EFS admin users to Okta</p></li>\n<li><p>Initial Sync of Portal users (panelists) to Okta</p></li>\n</ul></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"fixed-width\"><ac:layout-cell><p></p>\n<p><strong>Solution 3: On-Demand user import</strong></p>\n<p>Do not import all users before the activation of Questback Access but import them once they try to sign in to an installation.</p>\n<p>This will require some implementation which is “intercepting” the login on the login page, triggering an EFS installation to do the API import for the one user and then the user would receive an email to activate his account to sign in.</p></ac:layout-cell></ac:layout-section><ac:layout-section ac:breakout-mode=\"default\" ac:type=\"three_equal\"><ac:layout-cell><p><strong>Pro</strong></p>\n<ul>\n<li><p>No “dead users” in Okta (Panel Website Users)</p></li>\n<li><p>No timing issues with the activation mail</p></li>\n</ul></ac:layout-cell><ac:layout-cell><p><strong>Contra</strong></p>\n<ul>\n<li><p>Not a supported flow by Okta/OpenID Connect (Custom Integration)</p></li>\n<li><p>Big effort compared to the other solutions</p></li>\n</ul></ac:layout-cell><ac:layout-cell><p><strong>Solves</strong></p>\n<ul>\n<li><p>Initial Sync of EFS admin users to Okta</p></li>\n<li><p>Initial Sync of Portal users (panelists) to Okta</p></li>\n<li><p>Import via CSV for EFS Admin users</p></li>\n<li><p>Import via CSV for Portal users</p></li>\n</ul></ac:layout-cell></ac:layout-section></ac:layout>",
    "user_segment_ids": [
        360000084973
    ]
}