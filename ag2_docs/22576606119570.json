{
    "id": 22576606119570,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/22576606119570.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/22576606119570-How-to-Extract-a-List-of-Emails-Delivered-by-EFS-for-PE-Surveys-in-a-Specific-Timeframe",
    "author_id": 1904316023094,
    "comments_disabled": false,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20034388560530,
    "created_at": "2024-11-12T13:34:20Z",
    "updated_at": "2024-11-12T14:13:13Z",
    "name": "How to Extract a List of Emails Delivered by EFS for PE Surveys in a Specific Timeframe",
    "title": "How to Extract a List of Emails Delivered by EFS for PE Surveys in a Specific Timeframe",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-11-12T14:13:13Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [
        "EFS",
        "PE Surveys",
        "Emails",
        "Timeframe",
        "Database Query"
    ],
    "body": "<h1 id=\"h_01JCG9BEFAXZW6DMSGY13WGQBM\">Overview</h1>\n<p>Users may need to detect a list of emails delivered by EFS for PE surveys within a specific timeframe. This could be for various reasons such as post outage investigations. The problem arises when there is no direct query to fetch this information for all projects within an installation.</p>\n<h1 id=\"h_01JCG9BEFA1VTK6Q11TCV0XX6Y\">Solution</h1>\n<p>To solve this problem, you can use a specific database query to extract the required information. </p>\n<p>To build a new query, you can follow the steps in <a href=\"https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/22010573804818#01JCG9JXDNCFNS692TPM6Z062J\">DB Profiling</a>, or you can use the query below:</p>\n<pre style=\"padding: 8px; font-family: SFMono-Regular, Consolas, ' Liberation Mono' , Menlo, Courier, monospace; font-size: 12.025px; color: #2f3941; border-radius: 4px; display: block; margin: 0px; line-height: inherit; word-break: break-all; overflow-wrap: break-word; white-space: pre-wrap; background: #ffffff; border: 1px solid #d8dcde; outline: 0px; vertical-align: baseline; box-sizing: border-box; margin-block: 4px 12px; margin-inline: 0px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;\"><code style=\"font-family: SFMono-Regular, Consolas, ' Liberation Mono' , Menlo, Courier, monospace; font-size: 12px; color: #2f3941; border-radius: 0px; background: #ffffff; border: 0px; outline: 0px; vertical-align: baseline; box-sizing: border-box; line-height: inherit; white-space: pre-wrap; margin-block: 0px; margin-inline: 2px; padding-block: 0px; padding-inline: 5px; margin: 0px; padding: 0px;\">SELECT m.sid, m.uid,p.mail_id, m.mail_to AS rcpt, 0 AS status, COALESCE(CONVERT_TZ(m.dt, 'UTC', 'UTC'),'0000-00-00 00:00:00') AS dt,  \"\" AS realStatus, p.delivery, p.pid <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">FROM mail_prot AS p <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  JOIN mails AS m ON(p.mail_id=m.mail_id)   <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  LEFT JOIN mail_rcpt AS r ON(m.mail_id=r.mail_id AND m.uid=r.uid) <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">WHERE   <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  (m.delivery &amp; 1) <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  AND COALESCE(CONVERT_TZ(FROM_UNIXTIME(m.dt), 'UTC', 'UTC'), '0000-00-00 00:00:00')  BETWEEN <strong>'2024-11-10 12:00:00' AND '2024-11-11 11:00:00'</strong> <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  AND p.pid&gt;1 <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">UNION <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">SELECT r.sid, r.uid,p.mail_id, IF(v.rcpt IS NULL, 0, v.rcpt) AS rcpt, r.status, COALESCE(CONVERT_TZ(FROM_UNIXTIME(r.dt, \"%Y-%m-%d %H:%i\"), 'UTC', 'UTC'),'0000-00-00 00:00:00') AS dt, r.status AS realStatus, p.delivery, p.pid <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">FROM mail_prot AS p   <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  JOIN mail_rcpt AS r ON(p.mail_id=r.mail_id) <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  LEFT JOIN mails AS m ON(r.mail_id=m.mail_id AND r.uid=m.uid)   <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  LEFT JOIN mail_rcpt_val AS v ON (r.rcpt_hash=v.rcpt_hash) <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">WHERE  (m.uid IS NULL) <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  AND COALESCE(CONVERT_TZ(FROM_UNIXTIME(r.dt), 'UTC', 'UTC'), '0000-00-00 00:00:00')  BETWEEN <strong>'2024-11-10 12:00:00' AND '2024-11-11 11:00:00'</strong> <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  AND p.pid&gt;1 <br style=\"box-sizing: border-box; line-height: inherit; font-family: Consolas, ' Liberation Mono' , Menlo, ' Bitstream Vera Sans Mono' , Courier, monospace !important;\">  AND r.status=1;</code></pre>\n<p> </p>\n<ul>\n<li> Make sure to adjust the <strong>date and time (GMT)</strong> in the query to match your specific timeframe.</li>\n<li>To <strong>format the output</strong>, you can apply the following:\n<ul>\n<li>Copy the result and add it to a CSV file, then open in Excel. All data will be shown in 1 column by default, and no empty rows (unless each row is huge, this method will not work).</li>\n<li>Remove the header drawing rows (row 1 and 3)</li>\n<li>Select the column with the data, then click <code>Data &gt; Text to Columns &gt; Delimited</code><br><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/22577801312402\">\n</li>\n<li>Use the symbol <code>|</code> as delimiter</li>\n<li>Remove unnecessary columns, and rename columns to be clear for the customer</li>\n<li>If the report has the recipient emails, you can compress the csv, add a password, and share the password with the customer using <a href=\"https://onetimesecret.com/\">onetimesecret</a>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"h_01JCG9BEFA2PTABGBZ2DYBKQ8B\">Summary</h1>\n<p>By following these steps, you can successfully detect a list of emails delivered by EFS for PE surveys within a specific timeframe. This involves using the Admin Log, AWS logs, and a specific SQL query to extract the required information.</p>\n<h2 id=\"h_01JCG9BEFA6CT3M0WXEBP1E22J\">FAQ</h2>\n<ol>\n<li>\n<strong>What is EFS in this context?</strong><br>EFS stands for Email Feedback System. It's a system used to send surveys via email.</li>\n<li>\n<strong>What is the purpose of the SQL query provided?</strong><br>The SQL query is used to extract a list of emails delivered by EFS for PE surveys within a specific timeframe from the database.</li>\n<li>\n<strong>Can I use this method for other timeframes?</strong><br>Yes, you can adjust the date and time in the SQL query to match any timeframe you need.</li>\n</ol>",
    "user_segment_ids": [
        360000084973
    ]
}