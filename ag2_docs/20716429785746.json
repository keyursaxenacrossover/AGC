{
    "id": 20716429785746,
    "url": "https://discoverxi-supportdesk.zendesk.com/api/v2/help_center/en-us/articles/20716429785746.json",
    "html_url": "https://discoverxi-supportdesk.zendesk.com/hc/en-us/articles/20716429785746-Tivian-Application-Setup",
    "author_id": 369584192734,
    "comments_disabled": false,
    "draft": false,
    "promoted": false,
    "position": 0,
    "vote_sum": 0,
    "vote_count": 0,
    "section_id": 20714711445138,
    "created_at": "2024-08-12T19:04:59Z",
    "updated_at": "2024-08-28T09:02:20Z",
    "name": "Tivian Application Setup",
    "title": "Tivian Application Setup",
    "source_locale": "en-us",
    "locale": "en-us",
    "outdated": false,
    "outdated_locales": [],
    "edited_at": "2024-08-28T09:02:17Z",
    "user_segment_id": 360000084973,
    "permission_group_id": 1075294,
    "content_tag_ids": [],
    "label_names": [],
    "body": "<h1 id=\"h_01J6C3D7DFH4QESYEPVCZ8XZTY\">Overview</h1>\n<p>This guide provides a comprehensive overview of the essential prerequisites and configurations required for setting up and managing Tivian applications. It is designed to assist administrators in ensuring that all necessary components are correctly configured for optimal application performance and user experience.</p>\n<p> </p>\n<ul>\n<li><a href=\"#h_01J6C34VCYRH4EWFYJFYYW963R\">EFS Admin Configuration</a></li>\n<li><a href=\"#h_01J6C35SARP9V5ESNPRZPPZCBD\">Data Voyager Configuration</a></li>\n<li><a href=\"#h_01J6C38Z47RHASSSFBY803MX04\">Portals configuration</a></li>\n</ul>\n<p>Tivian Access uses Okta and is advertised with enhanced security. Thus every application has to use HTTPS. Tivian Access should not be enabled without HTTPS.</p>\n<p> </p>\n<h2 id=\"h_01J6C34VCYRH4EWFYJFYYW963R\">EFS Admin Configuration</h2>\n<h3 id=\"header-1\">Step 0: Whitelist</h3>\n<p>Take care that the Okta production address is whitelisted in our Proxy. Usually this should already be the case.</p>\n<h3 id=\"header-3\">Step 1: Navigate to platform cockpit</h3>\n<p><em>System → Options → Plattform-Cockpit → System configuration</em></p>\n<h3 id=\"header-5\">Step 2: Add IdentityAccessManager Module</h3>\n<p>The module IdentityAccessManager is not part of the default modules. It can be added when searching for “IdentityAccessManager”.</p>\n<p>The module depends on the modules “efs” and “survey” - they have to be added.</p>\n<p>In case Portals should be used for Tivian Access “panel“ and “portal” modules are also required and have to added.</p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21013437724306\" alt=\"module_setup.png\"></p>\n<p> </p>\n<h3 id=\"header-6\">Step 3: Configure IdentityAccessManager module</h3>\n<p><strong>Values:</strong></p>\n<p>see Module \"IdentityAccessManager\"</p>\n<p>also see General Tenant Setup and EFS Admin Setup and Authorization Server</p>\n<p><em><strong>iam_admin_bypass_login_route: </strong></em>A route that will be used for Tivian internal root users (leave at default)</p>\n<p><em><strong>iam_api_token</strong>:</em> The token created in the General Tenant Setup → KeyPass</p>\n<p><em><strong>iam_audience</strong>:</em> The audience that is configured in the Okta authorization server (Security → API → Authorization Servers)</p>\n<p><em><strong>iam_client_group_id: </strong></em>The ID of the groupd specified in Okta for that specific installation (Groups → ID in URL)</p>\n<p><em><strong>iam_client_id</strong>:</em> The ID of the created application in Okta for EFS Admin (Applications → Edit → General / KeyPass)</p>\n<p><em><strong>iam_client_secret</strong>:</em> The secret of the created application in Okta for EFS Admin (Applications → Edit → General / KeyPass)</p>\n<p><em><strong>iam_federated_domains</strong>:</em> domains that will be forwarded to the any IdP, see below (this option is important)</p>\n<p><em><strong>iam_idp_id: </strong></em>The identity provider ID that references the external identity provider (see below)</p>\n<p><em><strong>iam_panelist_sync:</strong></em> Adapt whether users should be synchronized and activated or not (see federated domains first)</p>\n<p><em><strong>iam_post_logout_redirect_url:</strong></em> &lt;domain and protocol&gt;/iam/admin/auth/logoutSuccess (technical domain, exept if the installation has a domain redirect from technical to an alias in place, then alias domain)</p>\n<p><em><strong>iam_proxy_url</strong>:</em> Ask IT second level support (most likely http://proxy:8080, exept AWS: <a href=\"http://squid.global-services.svc.cluster.local:8080\">http://squid.global-services.svc.cluster.local:8080</a>) → <u>also see below</u></p>\n<p><em><strong>iam_redirect_url</strong>:</em> &lt;domain and protocol&gt;/iam/admin/auth/login also see EFS Admin Setup (technical domain, exept if the installation has a domain redirect from technical to an alias in place, then alias domain)</p>\n<p><em><strong>iam_support_email</strong>:</em> The mail address of whoever will be answering questions regarding Tivian Access</p>\n<p><em><strong>iam_sso_modules:</strong></em> Adapt whether Tivian Access should be enabled for EFS Admin only or Portals too</p>\n<p><em><strong>iam_unique_customer_name:</strong></em> A unique name of the client that is also used for other Okta resources (see Naming conventions in Okta)</p>\n<p><em><strong>iam_user_group_id:</strong></em> This is the group ID of the client (the non-installation-specific one). It has to be created beforehand (Groups → ID in URL) (see General Tenant Setup).</p>\n<p><em><strong>iam_well_known_url</strong>: </em>The metadata URL that is proposed in the Authorization Server in Okta (Security → API → Edit → Metadata URI) also see Authorization Server</p>\n<p> </p>\n<h3 id=\"header-7\">Setp 4: Migrate admin users via script</h3>\n<p>This step is used to migrate admin users. The “iam_federated_domains” option has to be set here already to the correct final domain set.</p>\n<ul>\n<li>\n<p>Login to the console of the installation to start the migration script.</p>\n</li>\n<li>\n<p>Navigate to the “www“-folder of the installation.</p>\n</li>\n<li>\n<p>Execute the migration script in “support/iam/migration.php“.</p>\n</li>\n<li>\n<p>Chose “Admin user migration”</p>\n</li>\n<li>\n<p>Check if that worked (this is a good point in time to test with a client if everything works)</p>\n</li>\n</ul>\n<h3 id=\"header-8\">Step 5: Set IdentityAccessManager Module active</h3>\n<p><strong>Values:</strong></p>\n<p><em><strong>iam_module_active</strong>:</em> true (<strong>Caution:</strong> Enable this as soon as all other settings are correct! This will enable SSO. Only the root user can bypass the Okta login after this point.)</p>\n<p> </p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21013437730962\" alt=\"Screenshot_2019-12-19 Options.png\"></p>\n<p> </p>\n<h3 id=\"header-9\">Step 6: Activate admin users via script</h3>\n<p>The IAM module is now activated. But the respective admin users that are not part of the external IdP have to be activated to login.</p>\n<ul>\n<li>\n<p>Login to the console of the installation to start the migration script.</p>\n</li>\n<li>\n<p>Navigate to the “www“-folder of the installation.</p>\n</li>\n<li>\n<p>Execute the migration script in “support/iam/migration.php“.</p>\n</li>\n<li>\n<p>Chose “Admin user activation“</p>\n</li>\n</ul>\n<h3 id=\"header-10\">Step 7: Kill all activte sessions to avoid relogin after logout</h3>\n<ul>\n<li>\n<p>execute scipt: /www/support/iam/clearSessions.php</p>\n</li>\n<li>\n<p>error that idp_tokens does not exist can be ignored</p>\n</li>\n</ul>\n<h3 id=\"header-11\">Step 8: OPTIONAL - Migrate portals applications, Panelists and EFS Admin users with installation group ID</h3>\n<p>If the installation was setup with IAM in <strong>19.5</strong> this migration is mandatory. It will assign all users (EFS Admin users and Panelists) from the current installation to the installation specific group set in the EFS configuration.</p>\n<ul>\n<li>\n<p>Login to the console of the installation to start the migration script.</p>\n</li>\n<li>\n<p>Navigate to the “www“-folder of the installation</p>\n</li>\n<li>\n<p>Execute the migration script in “support/iam/migration.php”</p>\n</li>\n<li>\n<p>Chose “Portal ClientGroup migration“ - wait until done</p>\n</li>\n<li>\n<p>Execute the migration script again</p>\n</li>\n<li>\n<p>Chose “User ClientGroup migration“</p>\n</li>\n</ul>\n<p> </p>\n<h3 id=\"header-12\">Sync “Exclusion” (iam_federated_domains)</h3>\n<p>Users from EFS will be synced to Okta. A synced user will be created in Okta and will get an activation e-mail. The link in the activation e-mail will navigate the user to a page where the Okta password has to be provided.</p>\n<p>Also users from an Identity Provider would receive such an e-mail and would provide a password they would never use as they do not user their Okta user but their external Identity Provider user.</p>\n<p>To prevent such confusing e-mails users that are using their own Identity Provider will get synced to Okta without that kind of activation. Thus every e-mail domain that will get routed to an Identity Provider for this installation has to be added in the iam_federated_domains option.</p>\n<p>This has to happen before the sync is enabled. Else a wrong set of users will be migrated to Okta.</p>\n<p>Also see EFS Admin Setup</p>\n<h3 id=\"header-13\">Identity Provider ID (iam_idp_id)</h3>\n<p>If a customer has their own Identity Provider this provider is created as resource in Okta. In case a client wants their user to skip the identity provider discovery page that is shown in Okta, the ID of the identity provider resource in Okta could be set here.</p>\n<p>In that case the identity provider ID is already known in case a user tries to sign in and the user will be redirected to the identity provider directly without seeing an Okta page.</p>\n<p>This might have an effect on how Tivian users login.</p>\n<p> </p>\n<p><strong>Proxy:</strong></p>\n<p>In the current setup EFS runs in a proxy setup. Because of that the proxy has to be configured in the IAM config. But the URL also has to be whitelisted in the proxy. Otherwise EFS cannot reach Okta.</p>\n<p>3 incomplete <span class=\"placeholder-inline-tasks\"> please provide more details</span></p>\n<p> </p>\n<h2 id=\"h_01J6C35SARP9V5ESNPRZPPZCBD\">Data Voyager Configuration</h2>\n<h3 id=\"01J6C37A570WBRY43MP6ZYEG21\">Step 0: Whitelist</h3>\n<p>Take care that the Okta production address is whitelisted in our Proxy. Usually this should already be the case.</p>\n<h2 id=\"01J6C37A57AATKDC2MY72YRRV5\">Step 1: Navigate to Data Voyager settings</h2>\n<ol>\n<li>\n<p>login as root</p>\n</li>\n<li>\n<p>click on “Configurations (root)”</p>\n</li>\n<li>\n<p>search for “iam”</p>\n</li>\n</ol>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21013437735826\" alt=\"image-20200306-163314.png\"></p>\n<p> </p>\n<h3 id=\"01J6C37A57MCMB75MFQR569K6S\">Step 2: Configure</h3>\n<p>also see General Tenant Setup and Data Voyager Setup and Authorization Server Setup</p>\n<p><strong>Values:</strong></p>\n<p><em><strong>iam.sso.well_known_url: </strong></em> URL to the well known document from the Okta authorization server (see Authorization Server Setup )</p>\n<p><em><strong>iam.sso.redirect_url: </strong></em>&lt;dv-installation-url&gt;/dv/account/redirect/</p>\n<p><em><strong>iam.sso.client_id: </strong></em>ID of the DV application in Okta (see Data Voyager Setup )</p>\n<p><em><strong>iam.sso.client_secret: </strong></em>secret of the DV application in Okta (see Data Voyager Setup )</p>\n<p><em><strong>iam.sso.audience: </strong></em>audience value from the Okta authorization server (see Authorization Server Setup )</p>\n<p> </p>\n<h3 id=\"01J6C37A5753M863AESN4XG1RB\">Step 4: Create users</h3>\n<p>Users are created and managed manually in Okta and Datavoyager. Take care to assign the correct application specific group the the client.</p>\n<p>To use SSO in Data Voyager it is necessary to set the following lines manually in the application.ini of the Data Voyager installation, so the proxy can be used. (see below)</p>\n<pre><code class=\"language-text\">; Proxy configuration\niam.sso.proxy.url                     = \"http://proxy:8080\"</code></pre>\n<p> </p>\n<h3 id=\"01J6C37A576JACM6EA5N523CK9\">Step 5: Activate</h3>\n<p>Set Tivian Access to active in the configuration after checking all values again.</p>\n<p><em><strong>iam.sso.module_enabled: </strong></em>1</p>\n<p>In case something is not configured correctly you can login with root by using the following URL <code>&lt;dv-installation-url&gt;/dv/account/bypass</code></p>\n<p><img src=\"https://discoverxi-supportdesk.zendesk.com/hc/article_attachments/21013437740178\" alt=\"image-20200306-163636.png\"></p>\n<p> </p>\n<h2 id=\"h_01J6C38Z47RHASSSFBY803MX04\">Portals configuration</h2>\n<h3 id=\"01J6C3BKEA8CDF4E0V9V1MVFA3\">Step 1: Activate Portals in the EFS Admin UI</h3>\n<p>Login as root in the installation and navigate to the IdentityAccessManager configuration in the Platform Cockpit.</p>\n<p><em><strong>iam_sso_modules:</strong></em> Add “portal” here</p>\n<p> </p>\n<h3 id=\"01J6C3BKEAMRJR0A2BCBAYB91K\">Setp 2: Migrate portals via script</h3>\n<p>Already existing portals are not yet synced to Okta. Thus they have to be created.</p>\n<ul>\n<li>\n<p>Login to the console of the installation to start the migration script.</p>\n</li>\n<li>\n<p>Navigate to the “www“-folder of the installation.</p>\n</li>\n<li>\n<p>Execute the migration script in “support/iam/migration.php“.</p>\n</li>\n<li>\n<p>Chose “Portal migration”</p>\n</li>\n</ul>\n<p> </p>",
    "user_segment_ids": [
        360000084973
    ]
}